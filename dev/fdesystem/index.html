<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>System of Fractional Differential Equations Â· FractionalDiffEq.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://SciFracX.github.io/FractionalDiffEq.jl/fdesystem/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FractionalDiffEq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FractionalDiffEq.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">FractionalDiffEq.jl</a></li><li><a class="tocitem" href="../get_started/">Get Started</a></li><li><a class="tocitem" href="../multiterm/">Multi-term Fractional Differential Equations</a></li><li class="is-active"><a class="tocitem" href>System of Fractional Differential Equations</a><ul class="internal"><li><a class="tocitem" href="#Fractional-Order-Chua-System-Example"><span>Fractional Order Chua System Example</span></a></li><li><a class="tocitem" href="#Fractional-Order-Qi-Chaotic-System-Example"><span>Fractional Order Qi Chaotic System Example</span></a></li><li><a class="tocitem" href="#Fractional-Order-Lorenz-System"><span>Fractional Order Lorenz System</span></a></li></ul></li><li><a class="tocitem" href="../fpde/">Fractional Partial Differential Equations</a></li><li><a class="tocitem" href="../fdde/">Fractional Delay Differential Equations</a></li><li><a class="tocitem" href="../dode/">Distributed Order Differential Equations</a></li><li><a class="tocitem" href="../differences/">Fractional Differences Equations</a></li><li><a class="tocitem" href="../models/">Detailed Models</a></li><li><a class="tocitem" href="../problems/">Problems</a></li><li><a class="tocitem" href="../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../mittagleffler/">Mittag Leffler Function</a></li><li><a class="tocitem" href="../comparison/">Comparison</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>System of Fractional Differential Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>System of Fractional Differential Equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciFracX/FractionalDiffEq.jl/blob/master/docs/src/fdesystem.md#" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="System-of-fractional-differential-equations"><a class="docs-heading-anchor" href="#System-of-fractional-differential-equations">System of fractional differential equations</a><a id="System-of-fractional-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#System-of-fractional-differential-equations" title="Permalink"></a></h1><p>Many &quot;real life&quot; situations are governed by a system of fractional differential equations.</p><h2 id="Fractional-Order-Chua-System-Example"><a class="docs-heading-anchor" href="#Fractional-Order-Chua-System-Example">Fractional Order Chua System Example</a><a id="Fractional-Order-Chua-System-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Fractional-Order-Chua-System-Example" title="Permalink"></a></h2><p>So here, we will look at an example: <a href="https://en.wikipedia.org/wiki/Chua%27s_circuit">Chua circuit</a>.</p><p>The circuit diagram of the Chua system is shown below:</p><p><img src="../assets/chua_diode.svg" alt="Chua diode"/></p><blockquote><p>Here, <strong><span>$N_R$</span></strong> is the <a href="https://en.wikipedia.org/wiki/Memristor">memoristor</a>, which is a non-linear electrical component relating electric charge and magnetic flux linkage.</p></blockquote><p>Let&#39;s see if we abstract the Chua system into a fractional differential equation system:</p><p class="math-container">\[\begin{cases}
D^{\alpha_1}x=10.725\{y-1.7802x-[0.1927(|x+1|-|x-1|)]\}\\
D^{\alpha_2}y=x-y+z\\
D^{\alpha_3}z=-10.593y-0.268z
\end{cases}\]</p><p>Use the <code>NonLinearAlg</code> algorithm in FractionalDiffEq.jl to solve the Chua system and plot the result:</p><pre><code class="language-julia hljs">using FractionalDiffEq
using Plots

function chua(t, x, k)
    a = 10.725
    b = 10.593
    c = 0.268
    m0 = -1.1726
    m1 = -0.7872

    if k == 1
        f = m1*x[1]+0.5*(m0-m1)*(abs(x[1]+1)-abs(x[1]-1))
        y = a*(x[2]-x[1]-f)
        return y
    elseif k == 2
        y = x[1]-x[2]+x[3]
        return y
    elseif k == 3
        y = -b*x[2]-c*x[3]
        return y
    end
end

Î± = [0.93, 0.99, 0.92];
x0 = [0.2; -0.1; 0.1];
h = 0.001;
prob = FODESystem(chua, Î±, x0)
tn = 200;
result = solve(prob, h, tn, NonLinearAlg())

plot(result[:, 1], result[:, 2], title=&quot;Chua System&quot;, legend=:bottomright)</code></pre><p><img src="../assets/chua.png" alt="Chua"/></p><p>Cheers!ðŸŽ‰ðŸŽ‰ðŸŽ‰</p><p>It is noteworthy that in the reference book Fractional Calculus and Fractional-order Control<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, the computing time is almost 20 minutes to solve this problem in <a href="https://www.mathworks.com/matlabcentral/fileexchange/60874-fotf-toolbox">FOTF toolbox</a>, in my own computer, the computing time of FOTF toolbox is <strong>1499.940487</strong> seconds while in FractionalDiffEq.jl, the computing time has a speedup of about two times, only cost <strong>567.260306</strong> seconds!!</p><h3 id="Short-memory-effect-in-FDE"><a class="docs-heading-anchor" href="#Short-memory-effect-in-FDE">Short memory effect in FDE</a><a id="Short-memory-effect-in-FDE-1"></a><a class="docs-heading-anchor-permalink" href="#Short-memory-effect-in-FDE" title="Permalink"></a></h3><div class="admonition is-success"><header class="admonition-header">Why we use short memory effect in simulation?</header><div class="admonition-body"><p>While the Chua system is a real life chaos system, when we want to simulate the system more to see the system more clearly, we must increase the simulating time <span>$t_n$</span>, however, limited by the fact that the hardware resources and the computing capability can&#39;t increase endlessly, we need to use short memory effect to help us improve the simulating efficiency.</p></div></div><p>To further elaborate, we can look at how the short memory affects the simulation:</p><p>By using the same code above, but set <span>$t_n=500$</span> and memory length as <span>$L_0=10000$</span> to see the model more comprehensively but reduce the computing cost same time:</p><pre><code class="language-julia hljs">result = solve(prob, h, tn, NonLinearAlg(), 10000)</code></pre><p><img src="../assets/chua_short_memory.png" alt="Chua_short_memory"/></p><p>While in the reference<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, using FOTF toolbox costs 228.5s to solve the problem, in FractionalDiffEq.jl, the computing time is only almost 80s.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>The cost time doesn&#39;t use any multi-threading or parallel computing speedup.</p><pre><code class="language-julia-repl hljs">julia&gt; Threads.nthreads()
1</code></pre><p>So I think the performance would be more impressive by using multi-threading and paralell computing.</p></div></div><h2 id="Fractional-Order-Qi-Chaotic-System-Example"><a class="docs-heading-anchor" href="#Fractional-Order-Qi-Chaotic-System-Example">Fractional Order Qi Chaotic System Example</a><a id="Fractional-Order-Qi-Chaotic-System-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Fractional-Order-Qi-Chaotic-System-Example" title="Permalink"></a></h2><p>Since the Qi chaotic system is depicted as:</p><p class="math-container">\[\begin{cases}
\dot{x_1}=a(x_1-x_2)+x_2x_3\\
\dot{x_2}=cx_1-x_2-x_1x_3\\
\dot{x_3}=x_1x_2-bx_3
\end{cases}\]</p><p>We can also obtain the fractional order Qi chaotic system:</p><p class="math-container">\[\begin{cases}
D^\alpha x_1=a(x_1-x_2)+x_2x_3\\
D^\alpha x_2=cx_1-x_2-x_1x_3\\
D^\alpha x_3=x_1x_2-bx_3
\end{cases}\]</p><p>By abstract the mathematical model, and solve the equation system:</p><pre><code class="language-julia hljs">using FractionalDiffEq
using Plots

function qi(t, x, y, z, k)
    a, b, c, d, r = 35, 8/3, 80, -1, 1
    if k == 1
        return -a*x+a*y+r*y*z
    elseif k == 2
        return c*x+d*y-x*z
    elseif k == 3
        return -b*z+x*y
    end
end

alpha = [0.98, 0.98, 0.98]
h = 0.001
T = 50
x0 = [0.1, 0.2, 0.3]
prob = FODESystem(qi, alpha, x0)
x, y, z = solve(prob, h, T, GLWithMemory())

plot(x, y)</code></pre><p>We can get the phase portrait of the Qi chaotic system:</p><p><img src="../assets/qi.png" alt="GLWithMemory"/></p><h2 id="Fractional-Order-Lorenz-System"><a class="docs-heading-anchor" href="#Fractional-Order-Lorenz-System">Fractional Order Lorenz System</a><a id="Fractional-Order-Lorenz-System-1"></a><a class="docs-heading-anchor-permalink" href="#Fractional-Order-Lorenz-System" title="Permalink"></a></h2><p>Let&#39;s see if want to study the fractional order Lorenz system, FractionalDiffEq.jl is definitely a good tool for you!</p><p class="math-container">\[\begin{cases}
D^\alpha x_1=a(x_2-x_1)\\
D^\alpha x_2=cx_1-x_2x_3+dx_2\\
D^\alpha x_3=x_1x_2-bx_3
\end{cases}\]</p><p>With order <span>$\alpha=0.96$</span> and initial value <span>$x_0=[1, 2, 3]$</span></p><pre><code class="language-julia hljs">using FractionalDiffEq

function lorenz(t, x, y, z, k)
    a=40
    b=3
    c=10
    d=15
    if k==1
        return a*(y-x)
    elseif k==2
        return c*x-x*z+d*y
    elseif k==3
        return x*y-b*z
    end
end

Î±0 = [0.96, 0.96, 0.96]
x0 = [1, 2, 3]
h=0.001
prob=FODESystem(lorenz, Î±0, x0)
T=20
x, y, z=solve(prob, h, T, GLWithMemory())
using Plots
plot(x, z)

####################################
# Or use the detailed model in FractionalDiffEq.jl

a=40; b=3; c=10; d=15
prob = FractionalLorenz(a, b, c, d, 0.96)
x, y, z = solve(prob, h, T, LorenzADM())

using Plots
plot(x, z)</code></pre><p><img src="../assets/lorenz.png" alt="Lorenz"/></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>åˆ†æ•°é˜¶å¾®ç§¯åˆ†å­¦ä¸Žåˆ†æ•°é˜¶æŽ§åˆ¶ è–›å®šå®‡ ISBN:9787030543981 Page 208</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multiterm/">Â« Multi-term Fractional Differential Equations</a><a class="docs-footer-nextpage" href="../fpde/">Fractional Partial Differential Equations Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Sunday 27 February 2022 01:58">Sunday 27 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
